<!DOCTYPE html>
<html lang="en-us" class="scroll-smooth">
    <head><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>关于 Logseq</title>
<meta name="description" content="这两礼拜每天都在用 Logseq，真是太喜欢了。">
<link rel="canonical" href="http://www.jinhuaiyao.com/posts/about-logseq/">
<link rel="robots" href="/robots.txt" />

<link rel="stylesheet" href="http://www.jinhuaiyao.com/css/app.min.9d503e547f8ebf04cd24729d9049cff6c80e4afc8ecd5d753213ca60f7221c7a.css" integrity="sha256-nVA+VH+OvwTNJHKdkEnP9sgOSvyOzV11MhPKYPciHHo=" ></head>
    <body class="max-w-screen-md px-10 mx-auto">
        <header class="flex flex-col sm:flex-row items-center gap-5 sm:gap-10 pt-16 py-12">
    
  
<div class="flex-none w-20 h-20 rounded-full overflow-hidden" >
    <a href="http://www.jinhuaiyao.com/">
        <img srcset="/img/profile-picture_hu141d85d9bc1e471d962271e648f69e4d_967044_2000x2000_fill_q75_box_smart1.jpg 80w" src="/img/profile-picture.jpg" width="2087" height="2215" alt="Huaiyao Jin">
    </a>
</div>

    <div class="flex flex-col gap-5">
    <a href="http://www.jinhuaiyao.com/">
    
    <h3 class="text-center sm:text-left text-4xl font-extrabold text-gray-800 ">Huaiyao Jin</h3>
    
</a>
    <nav>
    <ul class="flex flex-wrap justify-left uppercase text-xs font-semibold gap-7 text-gray-500 ">
        
        
        <li class="hover:text-gray-500"><a href="/">Home</a></li>
        
        <li class="hover:text-gray-500"><a href="/posts">Posts</a></li>
        
    </ul>
</nav>
    </div>
</header>
        <main id="content">
<article class="flex flex-col gap-5">
    <header class="flex flex-col gap-2">
        <h2 class="text-xl leading-snug font-bold text-gray-900">关于 Logseq</h2>

        <div class="text-sm font-semibold text-gray-500 flex gap-3">
        
        
<time datetime="2022-07-02 13:55:55 &#43;0800 CST" title="2022-07-02 13:55:55 &#43;0800 CST">
    2022/07/02
</time>
        
        
        </div>
    </header>
    <section class="content text-base text-gray-800">
    <p>这两礼拜每天都在用 Logseq，真是太喜欢了。</p>
<p>这篇文章的形成也来自于 Logseq。</p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Logseq-sample_1.png" alt="Logseq"></p>
<h5 id="对我启发最大的两个资源">对我启发最大的两个资源</h5>
<ul>
<li><a href="https://www.bilibili.com/video/BV1X44y1K7X1?vd_source=326dc31e3febf5f2fd25078a753ea3d0">我如何使用 Logseq 管理我的生活和笔记</a></li>
<li><a href="https://limboy.me/posts/logseq/">我的 Logseq 使用习惯</a></li>
</ul>
<h5 id="macos-上的快速输入">macOS 上的快速输入</h5>
<p>自己做了一个非常简单的 Alfred workflow，把输入的内容附加在当天的 journal md 文件末尾。希望以后官方 app 能够发布更强大更高效的快速输入方式。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">query</span><span class="o">=</span><span class="nv">$1</span>
</span></span><span class="line"><span class="cl"><span class="nv">D1</span><span class="o">=</span><span class="sb">`</span>date <span class="s1">&#39;+%Y_%m_%d&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;\n- </span><span class="nv">$query</span><span class="s2">&#34;</span> &gt;&gt; <span class="s2">&#34;/Users/huajin/Library/Mobile Documents/iCloud~com~logseq~logseq/Documents/journals/</span><span class="si">${</span><span class="nv">D1</span><span class="si">}</span><span class="s2">.md&#34;</span>
</span></span></code></pre></div><h5 id="ios-上的快速输入">iOS 上的快速输入</h5>
<p>目前搞不定，等官方吧。</p>
<h5 id="dayone-迁移到-logseq">Dayone 迁移到 Logseq</h5>
<p>又花了一点时间把 Dayone 里的几千个记录迁移到 Logseq，慢慢带着加以整理、回顾、形成一些联系。
使用的是这个脚本， <a href="https://github.com/mhejda/dayone2logseq-md">dayone2markdown</a> 。</p>
<p>为了后续的一些文本批处理，还在 mac 上安装了 gnu sed。
比如如果 md 文件第一行是空行的话就把它删除。</p>
<p><code>/usr/local/opt/gnu-sed/libexec/gnubin/sed -i '1{/^$/d;}' *.md</code></p>
<p>也用到了 perl 的一个替换命令。</p>
<p><code>perl -pi -e &quot;s/\t- ####/- ####/g&quot; *.md</code></p>
<h5 id="daily-template">Daily template</h5>
<p>自定义好 daily_template_journals:</p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Logseq-daily-template_1.png" alt="daily-template"></p>
<p>每天早上打开 Journals，输入 /template 回车，然后选中 daily_template_journals 回车，就可以了。</p>
<h5 id="备份">备份</h5>
<p>Logseq 所有的内容是存在 iCloud 里的，只有一份，做为一名 DBA，重要的资料必须要有一份冗余。</p>
<p>一开始是想用 GoodSync 来同步所有文件到 OneDrive，发现订阅快到期了，于是用 macOS 上的 cron job 去 cp 整个目录。不过发现这样不太好，所有的文件都会在 OneDrive 里重新上传一次。最后改用了 rsync，只会拷备有变化的。</p>
<p><code>*/5 * * * * rsync -a &quot;/Users/huajin/Library/Mobile Documents/iCloud~com~logseq~logseq/Documents/&quot; &quot;/Users/huajin/Library/CloudStorage/OneDrive-Personal/Logseq_bak&quot;</code></p>
<p><em>-- update on 2022-07-03</em></p>
<p>今天发现 cron job 并没有运行成功，文件没有同步到 OneDrive。先给 cron job 加一段输出用来调试一下。</p>
<p><code>*/5 * * * * /usr/bin/rsync -a &quot;/Users/huajin/Library/Mobile Documents/iCloud~com~logseq~logseq/Documents/&quot; &quot;/Users/huajin/Library/CloudStorage/OneDrive-Personal/Logseq_bak&quot; &gt; /Users/huajin/Log/Logseq.bak.log 2&gt;&amp;1</code></p>
<p>看一下 Logseq.bak.log，有众多的 Operation not permitted 报错。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">rsync: failed to set times on &#34;/Users/huajin/Library/CloudStorage/OneDrive-Personal/Logseq_bak/logseq/bak/journals/2005-08-25&#34;: Operation not permitted (1)
</span></span><span class="line"><span class="cl">rsync: failed to set times on &#34;/Users/huajin/Library/CloudStorage/OneDrive-Personal/Logseq_bak/logseq/bak/journals/2005-08-26&#34;: Operation not permitted (1)
</span></span><span class="line"><span class="cl">rsync: failed to set times on &#34;/Users/huajin/Library/CloudStorage/OneDrive-Personal/Logseq_bak/logseq/bak/journals/2005-08-29&#34;: Operation not permitted (1)
</span></span><span class="line"><span class="cl">rsync: failed to set times on &#34;/Users/huajin/Library/CloudStorage/OneDrive-Personal/Logseq_bak/logseq/bak/journals/2005-08-30&#34;: Operation not permitted (1)
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></div><p>谷歌一下，找到了<a href="https://apple.stackexchange.com/questions/378553/crontab-operation-not-permitted">解决方法</a>。</p>
<p>简单的讲就是给<code>/usr/sbin/cron</code> 赋予 <code>Full Disk Access</code> 权限。</p>
<p><em>-- update on 2022-08-06</em></p>
<p>今天在 QNAP NAS 里开启了 Time Machine 服务，配置新 MacBook 上的 Time Machine 备份到 NAS 里，这样每个小时都会自动备份，又多了一重保障。</p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/logseq_backup_to_timemachine_2.png" alt=""></p>
<h5 id="那年今日">那年今日</h5>
<p><em>-- added on 2022-07-22</em></p>
<p>从 Dayone 迁移过来以后就想着在 Logseq 里实现类似 Dayone 里“那年今日”的功能。</p>
<p>本来想用 advanced query，可惜搞不定。只好用一些比较“笨拙”的方法。</p>
<p>在<del>旧 macbook 改造以后的 server</del> 新 MacBook Pro 上加一个 cron job。 <em>-- update on 2022-08-06</em></p>
<p><code>5 5 * * * /bin/bash  /Users/jinhuaiyao/Library/CloudStorage/OneDrive-Personal/Config/Mac_Script/on_this_day.sh &gt; /Users/jinhuaiyao/Log/on_this_day.log 2&gt;&amp;1</code></p>
<p><em>-- updated shell script on 2023-05-18</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span>  <span class="s2">&#34;/Users/jinhuaiyao/Library/Mobile Documents/iCloud~com~logseq~logseq/Documents/journals&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">DT</span><span class="o">=</span><span class="sb">`</span>date +%m_%d<span class="sb">`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">&gt; ../pages/On_This_Day.md<span class="p">;</span>
</span></span><span class="line"><span class="cl">ls <span class="p">|</span>grep <span class="s2">&#34;_</span><span class="nv">$DT</span><span class="s2">&#34;</span> <span class="p">|</span>sort <span class="p">|</span><span class="k">while</span> <span class="nb">read</span> file
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">$file</span> <span class="p">|</span>sed <span class="s1">&#39;s/.md//g&#39;</span><span class="p">|</span>sed <span class="s1">&#39;s/_/-/g&#39;</span> <span class="p">|</span>sed <span class="s1">&#39;s/^/- -------- [[/g&#39;</span> <span class="p">|</span>sed <span class="s1">&#39;s/$/]] --------/g&#39;</span> &gt;&gt; ../pages/On_This_Day.md
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;  collapsed:: true&#34;</span> &gt;&gt;../pages/On_This_Day.md
</span></span><span class="line"><span class="cl">awk <span class="s1">&#39;{print &#34;    &#34; $0}&#39;</span> <span class="s2">&#34;</span><span class="nv">$file</span><span class="s2">&#34;</span> &gt;&gt; ../pages/On_This_Day.md
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;\n-\n-\n&#34;</span> &gt;&gt; ../pages/On_This_Day.md
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span></code></pre></div><p>可以展开或折叠，效果如下。</p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/on_this_day_2.png" alt="on_this_day"></p>
    </section>
    
    
    

    
    

    <footer>
        
        <div class="pb-14 taxonomy-list tags-list text-gray-600 text-sm font-medium">
            
                    <a class="bg-gray-100 py-2 px-3 rounded-lg" href="/tags/%E6%96%B0%E4%BA%8B%E7%89%A9/" alt="新事物" >
                        新事物
                    </a>
            
                    <a class="bg-gray-100 py-2 px-3 rounded-lg" href="/tags/%E7%AC%94%E8%AE%B0/" alt="笔记" >
                        笔记
                    </a>
            
                    <a class="bg-gray-100 py-2 px-3 rounded-lg" href="/tags/shell/" alt="Shell" >
                        Shell
                    </a>
            
        </div>


    </footer>
</article>

        </main><footer class="pt-5 pb-10 grid gap-3 sm:grid-cols-2">
    <div class="text-xs font-semibold text-gray-500 order-2 sm:order-1 ">
    © 2017 - 2023  
</div>
    <div class="text-xs font-semibold text-gray-500 order-1 sm:order-2">
    <ul class="flex sm:justify-end gap-5">
    
    </ul>
</div>
</footer></body>
</html>
