<!DOCTYPE html>
<html lang="en-us" class="scroll-smooth">
    <head><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>关于 Notion</title>
<meta name="description" content="为什么用 Notion 最开始想尝试的是 Notion AI，想着把所有记录都放到 Notion 里，能不能通过 AI 发掘一些自己没有意识到的地方，去更好地了解自己，结果效果很一般。
使用三个月后的感受 今年9月初开始正式使用，目前感觉 Notion 有以下一些优点。
开箱即用，除了科学上网以外不需要太多的折腾。 数据库功能强大、易用。 界面简洁美观。 手机端方便好用，数据同步快速。 API 使用方便。 记录的内容及我自己的一些使用方法 日常所见所想 把日常的记录、待办事项都放到这个 Memos 的数据库里，用时间线去罗列。可以通过数据库的各种属性去展示和筛选。">
<link rel="canonical" href="http://www.jinhuaiyao.com/posts/about-notion/">
<link rel="robots" href="/robots.txt" />

<link rel="stylesheet" href="http://www.jinhuaiyao.com/css/app.min.40602969775ec83f8e99714fa2300cc28ba60bb57dba65fa9406f626a931d492.css" integrity="sha256-QGApaXdeyD+OmXFPojAMwoumC7V9umX6lAb2Jqkx1JI=" ></head>
    <body class="max-w-screen-md px-10 mx-auto">
        <header class="flex flex-col sm:flex-row items-center gap-5 sm:gap-10 pt-16 py-12">
    

<div class="flex-none w-20 h-20 rounded-full overflow-hidden">
    <a href="http://www.jinhuaiyao.com/">
        <img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/profile-picture.jpg" width="80" height="80" alt="Huaiyao Jin">
    </a>
</div>

    <div class="flex flex-col gap-5">
    <a href="http://www.jinhuaiyao.com/">
    
    <h3 class="text-center sm:text-left text-4xl font-extrabold text-gray-800 ">Huaiyao Jin</h3>
    
</a>
    <nav>
    <ul class="flex flex-wrap justify-left uppercase text-sm  gap-3 text-gray-500 ">
        
        
        <li class="hover:text-gray-500"><a href="/">首页</a></li>
        
        <li class="hover:text-gray-500"><a href="/posts">文章</a></li>
        
    </ul>
</nav>
    </div>
</header>
        <main id="content">
<article class="flex flex-col gap-5">

    <div class="fixed top-24 left-8 hidden lg:inline-block text-sm " >
        
    </div>


    <header class="flex flex-col gap-1 mb-5">
        <h2 class="text-xl leading-snug font-bold text-gray-900">关于 Notion</h2>

        <div class="text-xs font-semibold text-gray-500 flex gap-3">
        
        
<time datetime="2024-12-19 15:37:09 &#43;0800 CST" title="2024-12-19 15:37:09 &#43;0800 CST">
    2024/12/19
</time>
        
        
        </div>
    </header>
    </article>



    <section class="content text-base text-gray-800 mt-3">
    <h1 id="为什么用-notion">为什么用 Notion</h1>
<p>最开始想尝试的是 Notion AI，想着把所有记录都放到 Notion 里，能不能通过 AI 发掘一些自己没有意识到的地方，去更好地了解自己，结果效果很一般。</p>
<h1 id="使用三个月后的感受">使用三个月后的感受</h1>
<p>今年9月初开始正式使用，目前感觉 Notion 有以下一些优点。</p>
<ul>
<li>开箱即用，除了科学上网以外不需要太多的折腾。</li>
<li>数据库功能强大、易用。</li>
<li>界面简洁美观。</li>
<li>手机端方便好用，数据同步快速。</li>
<li>API 使用方便。</li>
</ul>
<h1 id="记录的内容及我自己的一些使用方法">记录的内容及我自己的一些使用方法</h1>
<h2 id="日常所见所想">日常所见所想</h2>
<p>把日常的记录、待办事项都放到这个 Memos 的数据库里，用时间线去罗列。可以通过数据库的各种属性去展示和筛选。</p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_15-04-21.png" alt=""></p>
<p>快捷输入，主要依赖于 Notion API 及苹果系统的快捷指令。快捷指令参考 <a href="https://www.youtube.com/watch?v=mKgi6CWedeg">https://www.youtube.com/watch?v=mKgi6CWedeg</a></p>
<h2 id="hahahugoshortcode-s0-hbhb"><figure><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/IMG_0070.JPG" width="40%"/>
</figure>
</h2>
<p>点击桌面上的 &ldquo;New Memos&rdquo;，键盘输入，长句子也可以通过苹果键盘自带的语音输入快速记录。</p>
<h2 id="hahahugoshortcode-s1-hbhb"><figure><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/IMG_0068.PNG" width="40%"/>
</figure>
</h2>
<p>记录就会插入 Memos 这个数据库。</p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_15-36-20.png" alt=""></p>
<p>锁屏界面也可以点击锁屏小组件调用快捷指令来快捷输入。</p>
<h2 id="hahahugoshortcode-s2-hbhb"><figure><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/IMG_0071.PNG" width="40%"/>
</figure>
</h2>
<h2 id="hahahugoshortcode-s3-hbhb"><figure><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/IMG_0072.PNG" width="40%"/>
</figure>
</h2>
<p>macOS 上结合 Alfred，可以实现类似手机端的快捷输入。</p>
<figure><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_16-00-25.png" width="60%"/>
</figure>

<p>先准备一个&quot;3 合 1&quot;的快捷指令，然后用 Aflred 的 workflow 去调用它。</p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_16-05-48.png" alt=""></p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_16-03-29.png" alt=""></p>
<p>Apple Watch上也可以调用快捷指令。</p>
<h2 id="hahahugoshortcode-s5-hbhb"><figure><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/incoming-1210D72F-6B3E-49A6-B41F-86D32244E8E5.PNG" width="30%"/>
</figure>
</h2>
<h2 id="晨间日记">晨间日记</h2>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_15-12-37.png" alt=""></p>
<p>通过日期列的筛选还可以实现&quot;那年今日&quot;的功能。</p>
<p>还可以使用自定义的模板。</p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_15-15-52.png" alt=""></p>
<p>年终回顾的时候，可以用特定的筛选条件来过滤今年的以及还没有 review 过的记录。</p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_16-16-24.png" alt=""></p>
<h2 id="待办事项">待办事项</h2>
<p>用来取代 Things，让完成的事项也有迹可寻。</p>
<p>每天重复的待办事项罗列得清楚。</p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_15-20-26.png" alt=""></p>
<p>通过 Notion 自动化，把完成的项目自动添加到 Memos 数据库。</p>
<h2 id="hahahugoshortcode-s6-hbhb"><figure><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_17-48-31.png" width="40%"/>
</figure>
</h2>
<p>其他重复的待办事项也一目了然，并且有自动化加持。</p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_15-23-58.png" alt=""></p>
<h2 id="hahahugoshortcode-s7-hbhb"><figure><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_16-21-16.png" width="40%"/>
</figure>
</h2>
<h2 id="hahahugoshortcode-s8-hbhb"><figure><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_16-21-34.png" width="60%"/>
</figure>
</h2>
<p>完成某一项待办事项的时候点击 Button，可以把当前日期附加到 Records 这一列当中，当作历史记录。同时会根据 Interval 和 Unit 计算下一次待办事项的日期，更新 NextTime 列。例如现在点一下 Button，结果如下：</p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_16-26-22.png" alt=""></p>
<p>Mac mini 上设置一个 cronjob 每天去检查 NextTime 列的日期，如果某条事项的日期是当天的话就更新 Text 列为当天的时间。当 Text 列被编辑，又会自动调用 Notion 的自动化去发出一个提醒到 Inbox 里，手机上也会有消息推送。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># Notion update for nexttime - 12/19/2024
</span></span><span class="line"><span class="cl">30 05 * * * /Users/jinhuaiyao/Dropbox/my_config/Mac_Script/notion_update_for_nexttime.py &gt;&gt; /Users/jinhuaiyao/Log/notion_update_for_nexttime.txt 2&gt;&amp;1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">jinhuaiyao@huaiyaos-mac-mini ~ % cat /Users/jinhuaiyao/Dropbox/my_config/Mac_Script/notion_update_for_nexttime.py
</span></span><span class="line"><span class="cl">#!/Library/Frameworks/Python.framework/Versions/3.12/bin/python3.12
</span></span><span class="line"><span class="cl">import requests
</span></span><span class="line"><span class="cl">import json
</span></span><span class="line"><span class="cl">from datetime import datetime, timedelta
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># API Token and Database ID
</span></span><span class="line"><span class="cl">NOTION_TOKEN = &#34;ntn_xxxx&#34;
</span></span><span class="line"><span class="cl">DATABASE_ID = &#34;13c41d2xxxxx&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Headers
</span></span><span class="line"><span class="cl">headers = {
</span></span><span class="line"><span class="cl">    &#34;Authorization&#34;: f&#34;Bearer {NOTION_TOKEN}&#34;,
</span></span><span class="line"><span class="cl">    &#34;Content-Type&#34;: &#34;application/json&#34;,
</span></span><span class="line"><span class="cl">    &#34;Notion-Version&#34;: &#34;2022-06-28&#34;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Today&#39;s date in ISO format
</span></span><span class="line"><span class="cl">current_date = datetime.utcnow().strftime(&#34;%Y-%m-%d&#34;)
</span></span><span class="line"><span class="cl"># UTC 0am, local 8 or 9am
</span></span><span class="line"><span class="cl">local_am_today = datetime.utcnow().replace(hour=0, minute=0, second=0, microsecond=0).isoformat()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Fetch database items
</span></span><span class="line"><span class="cl">url = f&#34;https://api.notion.com/v1/databases/{DATABASE_ID}/query&#34;
</span></span><span class="line"><span class="cl">response = requests.post(url, headers=headers)
</span></span><span class="line"><span class="cl">data = response.json()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">if &#34;results&#34; not in data:
</span></span><span class="line"><span class="cl">    print(&#34;Error fetching data from Notion:&#34;, data)
</span></span><span class="line"><span class="cl">    exit()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Iterate over database entries
</span></span><span class="line"><span class="cl">for page in data[&#34;results&#34;]:
</span></span><span class="line"><span class="cl">    properties = page.get(&#34;properties&#34;, {})
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    # Safely access NextTime property
</span></span><span class="line"><span class="cl">    next_time_property = properties.get(&#34;NextTime&#34;, None)
</span></span><span class="line"><span class="cl">    if next_time_property and isinstance(next_time_property, dict):
</span></span><span class="line"><span class="cl">        next_time_date = next_time_property.get(&#34;date&#34;, None)
</span></span><span class="line"><span class="cl">        if next_time_date and &#34;start&#34; in next_time_date:
</span></span><span class="line"><span class="cl">            next_time = next_time_date.get(&#34;start&#34;)
</span></span><span class="line"><span class="cl">            if next_time == current_date:
</span></span><span class="line"><span class="cl">                page_id = page[&#34;id&#34;]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                # Prepare payload to update Text property
</span></span><span class="line"><span class="cl">                text_payload = {
</span></span><span class="line"><span class="cl">                    &#34;properties&#34;: {
</span></span><span class="line"><span class="cl">                        &#34;Text&#34;: {
</span></span><span class="line"><span class="cl">                            &#34;rich_text&#34;: [
</span></span><span class="line"><span class="cl">                                {
</span></span><span class="line"><span class="cl">                                    &#34;type&#34;: &#34;mention&#34;,
</span></span><span class="line"><span class="cl">                                    &#34;mention&#34;: {
</span></span><span class="line"><span class="cl">                                        &#34;type&#34;: &#34;date&#34;,
</span></span><span class="line"><span class="cl">                                        &#34;date&#34;: {
</span></span><span class="line"><span class="cl">                                            &#34;start&#34;: local_am_today,
</span></span><span class="line"><span class="cl">                                            &#34;end&#34;: None,
</span></span><span class="line"><span class="cl">                                            &#34;time_zone&#34;: None
</span></span><span class="line"><span class="cl">                                        }
</span></span><span class="line"><span class="cl">                                    },
</span></span><span class="line"><span class="cl">                                    &#34;annotations&#34;: {
</span></span><span class="line"><span class="cl">                                        &#34;bold&#34;: False,
</span></span><span class="line"><span class="cl">                                        &#34;italic&#34;: False,
</span></span><span class="line"><span class="cl">                                        &#34;strikethrough&#34;: False,
</span></span><span class="line"><span class="cl">                                        &#34;underline&#34;: False,
</span></span><span class="line"><span class="cl">                                        &#34;code&#34;: False,
</span></span><span class="line"><span class="cl">                                        &#34;color&#34;: &#34;default&#34;
</span></span><span class="line"><span class="cl">                                    },
</span></span><span class="line"><span class="cl">                                    &#34;plain_text&#34;: local_am_today
</span></span><span class="line"><span class="cl">                                }
</span></span><span class="line"><span class="cl">                            ]
</span></span><span class="line"><span class="cl">                        }
</span></span><span class="line"><span class="cl">                    }
</span></span><span class="line"><span class="cl">                }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                # Update the page
</span></span><span class="line"><span class="cl">                update_url = f&#34;https://api.notion.com/v1/pages/{page_id}&#34;
</span></span><span class="line"><span class="cl">                update_response = requests.patch(update_url, headers=headers, json=text_payload)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                if update_response.status_code == 200:
</span></span><span class="line"><span class="cl">                    print(f&#34;Successfully updated Text property for page: {page_id}&#34;)
</span></span><span class="line"><span class="cl">                else:
</span></span><span class="line"><span class="cl">                    print(f&#34;Failed to update page {page_id}:&#34;, update_response.json())
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">jinhuaiyao@huaiyaos-mac-mini ~ % /Users/jinhuaiyao/Dropbox/my_config/Mac_Script/notion_update_for_nexttime.py
</span></span><span class="line"><span class="cl">Successfully updated Text property for page: 13c41d22-a693-8009-8515-e0ce0d4629f8
</span></span></code></pre></div><h2 id="hahahugoshortcode-s9-hbhb"><figure><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_16-38-40.png" width="40%"/>
</figure>
</h2>
<p>效果如下：</p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_16-34-28.png" alt=""></p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_16-34-44.png" alt=""></p>
<h2 id="等等的每日一照">等等的每日一照</h2>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_15-25-15.png" alt=""></p>
<h2 id="英文学习">英文学习</h2>
<p>可以标注并且添加注释。</p>
<p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_15-26-39.png" alt=""></p>
<h2 id="文章剪藏">文章剪藏</h2>
<p>电脑端
<a href="https://www.notion.com/web-clipper">https://www.notion.com/web-clipper</a></p>
<p>手机端，发送到Notion。</p>
<h2 id="hahahugoshortcode-s10-hbhb"><figure><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/IMG_0074.PNG" width="40%"/>
</figure>
</h2>
<h2 id="桌面小组件展示">桌面小组件展示</h2>
<p>利用 scriptable 这个 app 来调用 notion api 展示记录。</p>
<p>比如即将来临的待办事项显示在手机负一屏。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">// 配置参数
</span></span><span class="line"><span class="cl">max_lines = 15; 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">let notionData = await loadDataFromNotion();
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// 按照 plan_date 排序
</span></span><span class="line"><span class="cl">notionData.sort((a, b) =&gt; new Date(a.time) - new Date(b.time));
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">if (config.runsInWidget) {
</span></span><span class="line"><span class="cl">    let widget = await createWidget(notionData);
</span></span><span class="line"><span class="cl">    Script.setWidget(widget);
</span></span><span class="line"><span class="cl">} else if (config.runsWithSiri) {
</span></span><span class="line"><span class="cl">    let table = createTable(notionData);
</span></span><span class="line"><span class="cl">    await QuickLook.present(table);
</span></span><span class="line"><span class="cl">} else {
</span></span><span class="line"><span class="cl">    let table = createTable(notionData);
</span></span><span class="line"><span class="cl">    await QuickLook.present(table);
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Script.complete();
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">async function createWidget(notionData) {
</span></span><span class="line"><span class="cl">    // notionData 是一个数组，包含多个 {title, time}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    let gradient = new LinearGradient();
</span></span><span class="line"><span class="cl">    gradient.locations = [0, 1];
</span></span><span class="line"><span class="cl">    gradient.colors = [
</span></span><span class="line"><span class="cl">        new Color(&#34;#ffffff80&#34;),
</span></span><span class="line"><span class="cl">        new Color(&#34;#ffffff80&#34;)
</span></span><span class="line"><span class="cl">    ];
</span></span><span class="line"><span class="cl">    let widget = new ListWidget();
</span></span><span class="line"><span class="cl">    widget.backgroundColor = new Color(&#34;#ffffff80&#34;);
</span></span><span class="line"><span class="cl">    widget.backgroundGradient = gradient;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    // 显示所有记录
</span></span><span class="line"><span class="cl">    notionData.forEach(data =&gt; {
</span></span><span class="line"><span class="cl">        let timeElement = widget.addText(data.time);
</span></span><span class="line"><span class="cl">        timeElement.font = Font.mediumSystemFont(12);
</span></span><span class="line"><span class="cl">        timeElement.textColor = Color.black();
</span></span><span class="line"><span class="cl">        timeElement.lineLimit = 1;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        let titleElement = widget.addText(data.title);
</span></span><span class="line"><span class="cl">        titleElement.font = Font.boldSystemFont(16);
</span></span><span class="line"><span class="cl">        titleElement.textColor = Color.black();
</span></span><span class="line"><span class="cl">        titleElement.minimumScaleFactor = 0.75;
</span></span><span class="line"><span class="cl">        titleElement.lineLimit = 1;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        widget.addSpacer(8); // 在标题行下方增加间隔
</span></span><span class="line"><span class="cl">    });
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    return widget;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">function createTable(notionData) {
</span></span><span class="line"><span class="cl">    let table = new UITable();
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    // 显示所有记录
</span></span><span class="line"><span class="cl">    notionData.forEach(data =&gt; {
</span></span><span class="line"><span class="cl">        // 时间行
</span></span><span class="line"><span class="cl">        let row_time = new UITableRow();
</span></span><span class="line"><span class="cl">        row_time.addText(data.time);
</span></span><span class="line"><span class="cl">        row_time.cellSpacing = 0; // 消除间隙
</span></span><span class="line"><span class="cl">        table.addRow(row_time);
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        // 标题行
</span></span><span class="line"><span class="cl">        let row_title = new UITableRow();
</span></span><span class="line"><span class="cl">        row_title.addText(data.title);
</span></span><span class="line"><span class="cl">        row_title.cellSpacing = 0; // 消除间隙
</span></span><span class="line"><span class="cl">        row_title.height = 40; // 增加标题行下方的高度
</span></span><span class="line"><span class="cl">        table.addRow(row_title);
</span></span><span class="line"><span class="cl">    });
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    return table;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">async function loadDataFromNotion() {
</span></span><span class="line"><span class="cl">    let url = &#39;https://api.notion.com/v1/databases/xxxx/query&#39;;
</span></span><span class="line"><span class="cl">    let req = new Request(url);
</span></span><span class="line"><span class="cl">    req.method = &#39;POST&#39;;
</span></span><span class="line"><span class="cl">    req.headers = {
</span></span><span class="line"><span class="cl">        &#39;Authorization&#39;: &#39;Bearer ntn_xxxx&#39;, 
</span></span><span class="line"><span class="cl">        &#39;Content-Type&#39;: &#39;application/json&#39;,
</span></span><span class="line"><span class="cl">        &#39;Notion-Version&#39;: &#39;2022-06-28&#39;
</span></span><span class="line"><span class="cl">    };
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    // 获取当前时间，并格式化为 ISO 8601 字符串
</span></span><span class="line"><span class="cl">    let currentTime = new Date().toISOString();
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    let filterPayload = {
</span></span><span class="line"><span class="cl">        &#34;filter&#34;: {
</span></span><span class="line"><span class="cl">            &#34;and&#34;: [
</span></span><span class="line"><span class="cl">                {
</span></span><span class="line"><span class="cl">                    &#34;property&#34;: &#34;Tags&#34;,
</span></span><span class="line"><span class="cl">                    &#34;multi_select&#34;: {
</span></span><span class="line"><span class="cl">                        &#34;contains&#34;: &#34;Todo&#34;
</span></span><span class="line"><span class="cl">                    }
</span></span><span class="line"><span class="cl">                },
</span></span><span class="line"><span class="cl">                {
</span></span><span class="line"><span class="cl">                    &#34;property&#34;: &#34;PlanDate&#34;,
</span></span><span class="line"><span class="cl">                    &#34;date&#34;: {
</span></span><span class="line"><span class="cl">                        &#34;is_not_empty&#34;: true
</span></span><span class="line"><span class="cl">                    }
</span></span><span class="line"><span class="cl">                },
</span></span><span class="line"><span class="cl">                {
</span></span><span class="line"><span class="cl">                    &#34;property&#34;: &#34;Status&#34;,
</span></span><span class="line"><span class="cl">                    &#34;status&#34;: {
</span></span><span class="line"><span class="cl">                        &#34;equals&#34;: &#34;Not Started&#34;
</span></span><span class="line"><span class="cl">                    }
</span></span><span class="line"><span class="cl">                }
</span></span><span class="line"><span class="cl">            ]
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">    };
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    req.body = JSON.stringify(filterPayload);
</span></span><span class="line"><span class="cl">    let json = await req.loadJSON();
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    let results = json.results || []; // 确保 results 存在
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    // 提取所有符合条件的记录
</span></span><span class="line"><span class="cl">    let notionData = results.map(result =&gt; {
</span></span><span class="line"><span class="cl">        let title_content = result.properties.Content.title[0].text.content;
</span></span><span class="line"><span class="cl">        let plan_date_content = result.properties.PlanDate.date.start;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        // 格式化时间为中国时区
</span></span><span class="line"><span class="cl">        let time = formatTimeToChina(plan_date_content);
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        return {
</span></span><span class="line"><span class="cl">            title: title_content,
</span></span><span class="line"><span class="cl">            time: time
</span></span><span class="line"><span class="cl">        };
</span></span><span class="line"><span class="cl">    });
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    return notionData;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">function formatTimeToChina(time_content) {
</span></span><span class="line"><span class="cl">    let utc_time = new Date(time_content);
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    let options = {
</span></span><span class="line"><span class="cl">        timeZone: &#34;Asia/Shanghai&#34;,
</span></span><span class="line"><span class="cl">        year: &#39;numeric&#39;, month: &#39;2-digit&#39;, day: &#39;2-digit&#39;,
</span></span><span class="line"><span class="cl">        hour: &#39;2-digit&#39;, minute: &#39;2-digit&#39;, second: &#39;2-digit&#39;
</span></span><span class="line"><span class="cl">    };
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    return utc_time.toLocaleString(&#39;zh-CN&#39;, options);
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></div><p><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/Xnip2024-12-19_16-49-52.png" alt=""></p>
<h2 id="hahahugoshortcode-s11-hbhb"><figure><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/IMG_0073.PNG" width="40%"/>
</figure>
</h2>
<p>又比如一些重要的提醒循环显示在手机桌面。</p>
<h2 id="hahahugoshortcode-s12-hbhb"><figure><img src="https://huaiyao-image-hosting.oss-cn-shanghai.aliyuncs.com/images/IMG_0069.PNG" width="40%"/>
</figure>
</h2>
<h2 id="数据同步到-2024-打卡记录2024">数据同步到 <a href="/2024">2024 打卡记录</a></h2>
<p>Memos 数据库里特定 tag 的记录定期更新到打卡记录。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># upload heatmap data - 05/07/2024
</span></span><span class="line"><span class="cl">55 23 * * * /bin/bash /Users/jinhuaiyao/Dropbox/my_config/Mac_Script/upload_heatmap_data.sh &gt;/Users/jinhuaiyao/Log/upload_heatmap_data.txt 2&gt;&amp;1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">jinhuaiyao@huaiyaos-mac-mini .tmp % cat /Users/jinhuaiyao/Dropbox/my_config/Mac_Script/upload_heatmap_data.sh
</span></span><span class="line"><span class="cl">cd /Users/jinhuaiyao/.tmp/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DT=`date +%Y_%m_%d`
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">for file in `ls *.txt`
</span></span><span class="line"><span class="cl">do
</span></span><span class="line"><span class="cl">cp $file /Users/jinhuaiyao/OneDrive/Backup/backup_heatmap/${file}.${DT}
</span></span><span class="line"><span class="cl">done
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">bash workout.sh
</span></span><span class="line"><span class="cl">bash running.sh
</span></span><span class="line"><span class="cl">bash reading.sh
</span></span><span class="line"><span class="cl">bash vocabulary.sh
</span></span><span class="line"><span class="cl">bash englishpod.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cd /Users/jinhuaiyao/.tmp/
</span></span><span class="line"><span class="cl">scp -P 10086 *.txt xx@xx.xx.xx.xx:/home/xx/www/webpage
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">jinhuaiyao@huaiyaos-mac-mini .tmp % cat workout.sh
</span></span><span class="line"><span class="cl">/Library/Frameworks/Python.framework/Versions/3.12/bin/python3 workout.py &gt; workout.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">awk -F&#39; &#39; &#39;{print $1 &#34; |1| &#34; substr($0, index($0,$3))}&#39; workout.1  &gt; workout.2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">awk -F&#39;|&#39; &#39;
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    key = $1 FS $2;
</span></span><span class="line"><span class="cl">    if (key in data) {
</span></span><span class="line"><span class="cl">        data[key] = data[key] &#34;, &#34; $3;
</span></span><span class="line"><span class="cl">    } else {
</span></span><span class="line"><span class="cl">        data[key] = $3;
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">END {
</span></span><span class="line"><span class="cl">    for (key in data) {
</span></span><span class="line"><span class="cl">        print key &#34; |&#34; data[key];
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}&#39;  workout.2 |sort &gt;workout.3
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat workout.txt.base workout.3  &gt; workout.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">jinhuaiyao@huaiyaos-mac-mini .tmp % cat workout.py
</span></span><span class="line"><span class="cl">import requests
</span></span><span class="line"><span class="cl">import json
</span></span><span class="line"><span class="cl">import pytz
</span></span><span class="line"><span class="cl">from datetime import datetime
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># API 令牌
</span></span><span class="line"><span class="cl">NOTION_TOKEN = &#34;ntn_xxxx&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 数据库ID
</span></span><span class="line"><span class="cl">DATABASE_ID = &#34;4bd4xxxx&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 请求头
</span></span><span class="line"><span class="cl">headers = {
</span></span><span class="line"><span class="cl">    &#34;Authorization&#34;: f&#34;Bearer {NOTION_TOKEN}&#34;,
</span></span><span class="line"><span class="cl">    &#34;Content-Type&#34;: &#34;application/json&#34;,
</span></span><span class="line"><span class="cl">    &#34;Notion-Version&#34;: &#34;2022-06-28&#34;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 定义过滤条件，筛选带有 &#34;Workout&#34; 标签的项目
</span></span><span class="line"><span class="cl">filter_payload = {
</span></span><span class="line"><span class="cl">    &#34;filter&#34;: {
</span></span><span class="line"><span class="cl">        &#34;property&#34;: &#34;Tags&#34;,  # 属性名称，假设为 &#34;Tags&#34;
</span></span><span class="line"><span class="cl">        &#34;multi_select&#34;: {
</span></span><span class="line"><span class="cl">            &#34;contains&#34;: &#34;Workout&#34;  # 标签内容
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 查询数据库的API URL
</span></span><span class="line"><span class="cl">url = f&#34;https://api.notion.com/v1/databases/{DATABASE_ID}/query&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 发送带有过滤器的请求
</span></span><span class="line"><span class="cl">response = requests.post(url, headers=headers, json=filter_payload)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 解析并打印响应结果
</span></span><span class="line"><span class="cl">data = response.json()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 提取并解码内容
</span></span><span class="line"><span class="cl">for result in data[&#34;results&#34;]:
</span></span><span class="line"><span class="cl">    # 假设 Content 在 properties 里面，获取 title 属性中的内容
</span></span><span class="line"><span class="cl">    title_content = result[&#34;properties&#34;][&#34;Content&#34;][&#34;title&#34;][0][&#34;text&#34;][&#34;content&#34;]
</span></span><span class="line"><span class="cl">    time_content = result[&#34;properties&#34;][&#34;Time&#34;][&#34;created_time&#34;]
</span></span><span class="line"><span class="cl">    utc_format = &#34;%Y-%m-%dT%H:%M:%S.%fZ&#34;
</span></span><span class="line"><span class="cl">    utc_time = datetime.strptime(time_content, utc_format)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		# 设置时区：UTC 和 东八区
</span></span><span class="line"><span class="cl">    utc = pytz.timezone(&#39;UTC&#39;)
</span></span><span class="line"><span class="cl">    cn_tz = pytz.timezone(&#39;Asia/Shanghai&#39;)
</span></span><span class="line"><span class="cl">    utc_time = utc.localize(utc_time)
</span></span><span class="line"><span class="cl">    cn_time = utc_time.astimezone(cn_tz)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    # 打印解码后的标题内容
</span></span><span class="line"><span class="cl">    print(f&#34;{cn_time}: {title_content}&#34;)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">jinhuaiyao@huaiyaos-mac-mini .tmp % tail workout.txt
</span></span><span class="line"><span class="cl">2024-09-23 |1 | 跑步5km
</span></span><span class="line"><span class="cl">2024-10-02 |1 | 跑步5km
</span></span><span class="line"><span class="cl">2024-10-03 |1 | 跑步5.7km
</span></span><span class="line"><span class="cl">2024-10-05 |1 | 跑步6.1km
</span></span><span class="line"><span class="cl">2024-10-13 |1 | 顾村公园快走
</span></span><span class="line"><span class="cl">2024-10-20 |1 | 陪等等散步
</span></span><span class="line"><span class="cl">2024-11-02 |1 | 跳绳
</span></span><span class="line"><span class="cl">2024-11-09 |1 | 和等等踢球
</span></span><span class="line"><span class="cl">2024-11-11 |1 | 跳绳300个
</span></span><span class="line"><span class="cl">2024-11-30 |1 | 跳绳600
</span></span></code></pre></div>
    </section>




    


    <footer>
        


    </footer>





        </main>
        <br><footer class="pt-5 pb-10 grid gap-3 sm:grid-cols-2">
    <div class="text-xs font-semibold text-gray-500 order-2 sm:order-1 ">
    © 2017 - 2024  
</div>
    <div class="text-xs font-semibold text-gray-500 order-1 sm:order-2">
    <ul class="flex sm:justify-end gap-5">
    
    </ul>
</div>
</footer></body>
</html>
