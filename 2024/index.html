<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>读取文本数据并显示热图</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.3.0/dist/echarts.min.js"></script>
    <style>
        #heatmap {
            width: 1200px;
            height: 400px;
            margin: 20px auto;
        }
    </style>
</head>
<body>
<div id="heatmap"></div>
<script type="text/javascript">
    var chartDom = document.getElementById('heatmap');
    var myChart = echarts.init(chartDom);

    // 初始化空图表
    var option = {
        tooltip: {
            position: 'top',
            formatter: function (params) {
                return '' + params.value[0] + '<br>' + params.value[1];
            }
        },
        calendar: {
            top: 'middle',
            left: 'center',
            orient: 'horizontal',
            cellSize: [20, 20],
            range: '2024',  // 明确设置为2024年
            itemStyle: {
                borderWidth: 1,
                borderColor: '#ccc'
            }
        },
        series: [{
            type: 'heatmap',
            coordinateSystem: 'calendar',
            data: []
        }]
    };
    myChart.setOption(option);

    fetch('https://utils.jinhuaiyao.com/data.txt')
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.text();
    })
    .then(text => {
        const data = text.split('\n').map(line => {
            const parts = line.split(',');
            if (parts.length === 2) {
                return [parts[0].trim(), +parts[1].trim()];
            }
            return null;
        }).filter(item => item !== null);
        // 这里更新你的图表数据
        myChart.setOption({
            series: [{
                data: data
            }]
        });
    })
    .catch(error => {
        console.error('There has been a problem with your fetch operation:', error);
    });
</script>
</body>
</html>
